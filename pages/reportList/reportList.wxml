<!-- pages/reportList/reportList.wxml -->
<view class="report-list-container">
  <!-- 顶部导航 -->
  <view class="navbar">
    <view class="title">我的体检报告</view>
    <view class="logout-btn" bindtap="logout">退出</view>
  </view>

  <!-- 搜索区域 -->
  <view class="search-container">
    <view class="search-box">
      <image src="/images/icon_search.png" class="search-icon"></image>
      <input 
        class="search-input"
        value="{{searchKeyword}}"
        placeholder="搜索报告名称..."
        bindinput="onSearchInput"
        bindconfirm="onSearchConfirm"
      />
      <view class="clear-btn" bindtap="clearSearch" wx:if="{{searchKeyword}}">
        <image src="/images/icon_clear.png" class="clear-icon"></image>
      </view>
    </view>
  </view>

  <!-- 筛选区域（仅保留时间筛选） -->
  <view class="filter-bar">
    <view class="filter-item" bindtap="showTimeFilter">
      <text>{{timeFilterText}}</text>
      <image src="/images/icon_arrow_down.png" class="filter-icon {{showTimeFilterPopup ? 'active' : ''}}"></image>
    </view>
    <view 
      class="filter-reset" 
      bindtap="resetFilters"
      wx:if="{{isFilterApplied}}"
    >
      重置筛选
    </view>
  </view>

  <!-- 时间筛选弹窗 -->
  <view class="popup-mask" wx:if="{{showTimeFilterPopup}}" bindtap="hideTimeFilter"></view>
  <view class="popup slide-up" wx:if="{{showTimeFilterPopup}}">
    <view class="popup-title">选择时间范围</view>
    <view class="filter-options">
      <view 
        class="filter-option {{timeFilter === 'all' ? 'active' : ''}}"
        bindtap="selectTimeFilter"
        data-value="all"
      >
        全部时间
      </view>
      <view 
        class="filter-option {{timeFilter === 'week' ? 'active' : ''}}"
        bindtap="selectTimeFilter"
        data-value="week"
      >
        近一周
      </view>
      <view 
        class="filter-option {{timeFilter === 'month' ? 'active' : ''}}"
        bindtap="selectTimeFilter"
        data-value="month"
      >
        近一个月
      </view>
      <view 
        class="filter-option {{timeFilter === 'quarter' ? 'active' : ''}}"
        bindtap="selectTimeFilter"
        data-value="quarter"
      >
        近三个月
      </view>
      <view 
        class="filter-option {{timeFilter === 'year' ? 'active' : ''}}"
        bindtap="selectTimeFilter"
        data-value="year"
      >
        近一年
      </view>
    </view>
    <view class="popup-confirm" bindtap="confirmTimeFilter">确认</view>
  </view>

  <!-- 报告列表 -->
  <view class="report-list">
    <!-- 加载状态 -->
    <view class="loading-container" wx:if="{{loading && filteredReports.length === 0}}">
      <view class="custom-loading"></view>
      <text class="loading-text">加载报告中...</text>
    </view>

    <!-- 空状态 -->
    <view class="empty-state" wx:if="{{!loading && isEmpty}}">
      <image src="/images/icon_empty.png" class="empty-img"></image>
      <text class="empty-text">暂无体检报告记录</text>
      <button class="empty-btn" bindtap="goBack">重新查询</button>
    </view>

    <!-- 报告项 -->
    <view 
      class="report-item" 
      wx:for="{{filteredReports}}" 
      wx:key="id"
      bindtap="viewReport"
      data-url="{{item.Url}}"
      data-id="{{item.Id}}"
    >
      <view class="report-header">
        <view class="report-title">{{item.Name || item.name}}</view>
        <view class="report-date">{{item.Time || item.time}}</view>
      </view>
      <view class="report-type">
        <view class="type-tag {{item.Type === 'physical' ? 'type-physical' : item.Type === 'test' ? 'type-test' : item.Type === 'imaging' ? 'type-imaging' : 'type-consultation'}}">
          {{'体检报告'}}
        </view>
        <view class="report-hospital">{{'沈阳市沈北新区中医院'}}</view>
      </view>
      <view class="report-footer">
        <text class="report-status">已完成</text>
        <image src="/images/icon_arrow_right.png" class="report-arrow"></image>
      </view>
    </view>
  </view>
</view>
    