<view class="page-container">
  <!-- 顶部导航 -->
  <view class="nav-bar">
    <view class="nav-title">个人中心</view>
    <view class="nav-back" bindtap="goBack">
      <image src="https://picsum.photos/id/5/36/36" class="back-icon" tint-color="white" alt="返回"></image>
    </view>
  </view>

  <!-- 用户信息卡片 -->
  <view class="user-card">
    <view class="avatar-container">
      <image src="{{userInfo.avatarUrl || 'https://picsum.photos/id/91/120/120'}}" class="avatar" alt="用户头像"></image>
      <view class="edit-avatar" bindtap="chooseAvatar">
        <image src="https://picsum.photos/id/15/30/30" class="edit-icon" alt="编辑头像"></image>
      </view>
    </view>
    
    <view class="user-info">
      <view class="user-name">{{userInfo.name || '未设置'}}</view>
      <view class="user-id">身份证号: {{formatIdCard(userInfo.IdCard)}}</view>
      <view class="user-phone">手机号: {{formatPhone(userInfo.PhoneNumber)}}</view>
    </view>
  </view>

  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-spinner"></view>
    <text class="loading-text">加载中...</text>
  </view>

  <!-- 错误状态 -->
  <view wx:if="{{error && !loading}}" class="error-container">
    <image src="https://picsum.photos/id/7/160/160" class="error-img" alt="错误"></image>
    <text class="error-text">{{errorMsg}}</text>
    <view class="retry-btn" bindtap="loadUserInfo">重试</view>
  </view>

  <!-- 用户信息表单 -->
  <view wx:if="{{!loading && !error}}" class="info-form">
    <view class="form-section">
      <text class="section-title">基本信息</text>
      
      <view class="form-item">
        <text class="item-label">姓名</text>
        <input 
          class="item-input" 
          placeholder="请输入姓名" 
          value="{{userInfo.name}}"
          bindinput="onNameChange"
        ></input>
      </view>
      
      <view class="form-item">
        <text class="item-label">性别</text>
        <picker mode="selector" range="{{genderOptions}}" value="{{genderIndex}}" bindchange="onGenderChange">
          <view class="picker-view">{{genderOptions[genderIndex]}}</view>
        </picker>
      </view>
      
      <view class="form-item">
        <text class="item-label">出生日期</text>
        <picker mode="date" value="{{userInfo.birthday}}" start="1900-01-01" end="{{currentDate}}" bindchange="onBirthdayChange">
          <view class="picker-view">{{userInfo.birthday || '选择出生日期'}}</view>
        </picker>
      </view>
    </view>
    
    <view class="form-section">
      <text class="section-title">联系信息</text>
      
      <view class="form-item">
        <text class="item-label">手机号</text>
        <text class="item-value">{{userInfo.PhoneNumber || '未设置'}}</text>
        <view class="item-action" bindtap="goToChangePhone">修改</view>
      </view>
      
      <view class="form-item">
        <text class="item-label">邮箱</text>
        <input 
          class="item-input" 
          placeholder="请输入邮箱（选填）" 
          value="{{userInfo.email}}"
          bindinput="onEmailChange"
          type="text"
        ></input>
      </view>
    </view>
    
    <view class="form-section">
      <text class="section-title">其他设置</text>
      
      <view class="form-item action-item" bindtap="clearCache">
        <text class="item-label">清除缓存</text>
        <text class="cache-size">{{cacheSize}}</text>
        <image src="https://picsum.photos/id/13/30/30" class="arrow-icon" alt="箭头"></image>
      </view>
      
      <view class="form-item action-item" bindtap="showAbout">
        <text class="item-label">关于我们</text>
        <image src="https://picsum.photos/id/13/30/30" class="arrow-icon" alt="箭头"></image>
      </view>
    </view>
    
    <view class="btn-primary save-btn" bindtap="saveUserInfo">保存信息</view>
    
    <view class="logout-btn" bindtap="logout">退出登录</view>
  </view>
</view>
    